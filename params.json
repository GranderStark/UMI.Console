{"name":"UMI.Console","tagline":"Консольная утилита UMI.CMS","body":"# UMI.Console\r\n\r\nКонсольная утилита UMI.CMS\r\n\r\n## Установка\r\n\r\n    curl -O  http://ilyar.github.io/UMI.Console/umi-cli.phar\r\n    chmod +x umi-cli.phar\r\n    mv umi-cli.phar /usr/local/bin/umi\r\n\r\n## Использование\r\n\r\nВсе команды необходимо выполнять в директории системы\r\n\r\n    $ umi <command> [action] [flags] [options [options [...]] [<args> [<args> [...]]\r\n\r\nОтобразить список доступных команд\r\n\r\n    $ umi\r\n\r\n### Показать информацию о текущей UMI.CMS\r\n\r\n    $ umi info\r\n\r\n### Показать базовые типы данных\r\n\r\n    $ umi type list -nm\r\n* **-n** показать название\r\n* **-m** показать модуль-метод\r\n\r\n### Показать все типы данных\r\n\r\n    $ umi type list -AnG\r\n* **-A** показать все типы данных\r\n* **-n** показать название\r\n* **-G** показать GUID\r\n* **-g** Узнать, помечен ли тип данных как справочник\r\n* **-l** Узнать, заблокирован ли тип данных\r\n\r\n### Скопировать структуру типа данных\r\n\r\n    $ umi type cp id_source id_target [--group=all [--field=all]\r\n\r\n### перемещение или переименование групп, полей Типов данных\r\n\r\n    $ umi type mv --group=name|id type_id new_name|new_title -n|-t\r\n\r\n### Показать информацию\r\n\r\n    $ umi type view {typeId}\r\n\r\n### Редактировать тип данных\r\n\r\n    $ umi type edit {typeId} [--guid=null [--locked=false [--delete=false]\r\n* **--guid** или **-g** установить GUID\r\n* **--locked** или **-l** заблокировать\r\n* **--delete** или **-g** удвлить\r\n\r\n### Выборки\r\n\r\n    $ umi sel --mode=pages --type_guid=content-page -nc\r\n    $ umi sel --mode=objects --type_guid=content-page --type_guid=users-user -cn\r\n\r\n### Манипуляции над страницами (элементы) ситемы\r\n\r\nУстановить источник данных для элемента\r\n\r\n    $ umi element chobj {elementId} {objectId}\r\n\r\nУстановить права `level` на страницу `rootId` и ее подстраницы для пользователя или группы\r\n\r\n    $ umi element permission {rootId} {ownerId} {level}\r\n\r\nУдалить все права на страницу `rootId` и ее подстраницы для всех пользователей\r\n\r\n    $ umi element permission {rootId} --reset\r\n\r\nУдалить все права на страницу `rootId` и ее подстраницы для пользователя или группы\r\n\r\n    $ umi element permission {rootId} {ownerId} --reset\r\n\r\nУдалить все права на страницу `rootId` и ее подстраницы для всех пользователей и установить права level для пользователя или группы\r\n\r\n    $ umi element permission {rootId} {ownerId} {level} --reset\r\n\r\nДополнительные параметры выборки и значения поумолчанию\r\n\r\n* --domainId = 1 указать индентификатор домена (актуально если ишем от корня: rootId = 0)\r\n* --langId = 1 указать индентификатор языка (актуально если ишем от корня: rootId = 0)\r\n* --unActive = true если true, то в результат будут включены неактивные страницы\r\n* --unVisible = true если true, то в результат будут включены невидимые в меню страницы\r\n* --depth = 0  глубина поиска\r\n* --typeId = false включить в результат только страницы с указанным идентификатора базового типа (umiHierarchyType)\r\n* --addSelf = true включить в результат rootId\r\n\r\n### Управление рестрикшенами [baseRestriction](http://api.docs.umi-cms.ru/spravochnik_po_klassam_yadra_umicms/model_dannyh/baserestriction/)\r\n\r\nСписок рестрикшенов\r\n\r\n    $ umi restriction list\r\n\r\nДобавить новый рестрикшен\r\n\r\n    $ umi restriction add {fieldTypeId} {title} {prefix}\r\n\r\nНазначить полую рестрикшен\r\n\r\n    $ umi restriction set {fieldId} {restrictionId}\r\n\r\n### Проверка контролной суммы файлов системы\r\n\r\n    $ umi file\r\n\r\n### Выполнение бекапа\r\n\r\n    $ umi backup\r\n\r\n### Управление системными перенаправлениями (редиректами)\r\n\r\nПолучить список перенаправлений\r\n\r\n    $ umi redirect list\r\n\r\nДобавить новое перенаправление\r\n\r\n    $ umi redirect add {oldURL} {newURL} [status=301]\r\n\r\nУдалить перенаправление\r\n\r\n    $ umi redirect del {redirectId}\r\n\r\nПолучить список перенаправлений со страницы `sourceURL`\r\n\r\n    $ umi redirect get {sourceURL}\r\n\r\n### Миграция типов данных\r\n\r\nФормирование и применение [UMIDump 2.0](http://api.docs.umi-cms.ru/razrabotka_nestandartnogo_funkcionala/format_umidump_20/opisanie_formata/) на основе JSON-конфига.\r\nПо умолчанию файл настройки миграции называется `migrate.json` и должен быть расположен директории шаблона `~/templates/{имя_шаблона}/db/migrate.json`, пример:\r\n\r\n```json\r\n{\r\n  \"registry\": {\r\n    \"paths\": [\"//\"],\r\n    \"exclude\": [\"settings/keycode\", \"umiMessages/lastConnectTime\"]\r\n  },\r\n  \"domains\": [\"all\"],\r\n  \"templates\": [1, 2],\r\n  \"types\": [\r\n    \"users-user\",\r\n    \"banners-banner\"\r\n  ],\r\n  \"relations\": [\"domains\", \"langs\", \"templates\", \"fields_relations\", \"restrictions\", \"permissions\"]\r\n}\r\n```\r\n\r\nФормирование `UMIDump` (экспорт)\r\n\r\n    $ umi migrate [save [--name=migrate] # будет создан файл `~/templates/{имя_шаблона}/db/migrate.xml`\r\n\r\nПрименение `UMIDump` (импорт)\r\n\r\n    $ umi migrate apply [--name=migrate] # будет применен файл `~/templates/{имя_шаблона}/db/migrate.xml`\r\n\r\n### Управление правами пользователей и групп\r\n\r\n    $ umi perm\r\n\r\n\r\n### Unix pipe, показать тип данных **Раздел сайта**\r\n\r\n    $ umi type -AG | grep root-pages | awk '{print $1}' | umi type view -A\r\n\r\n## Планы\r\n\r\n- Покрытие тестами\r\n- Рефакторинг PHP >= 5.4\r\n- PSR-2, PSR-4\r\n- PSR-3\r\n\r\n## Лицензия\r\n\r\nФайлы в этом репозитории находятся под действием лицензии BSD.\r\nКопия данной лицензии доступна в [LICENSE](LICENSE.md).\r\n","google":"UA-47068199-1","note":"Don't delete this file! It's used internally to help with page regeneration."}